{% extends 'base.html' %}

{% block title %}Proyectos - Atenea{% endblock %}

{% block content %}
<!-- Header -->
<div class="mb-8">
    <h1 class="text-4xl font-bold mb-2">Proyectos</h1>
    <p class="text-gray-600">Gestiona tus proyectos de generaci√≥n de contenido IA</p>
</div>

<!-- Proyectos -->
<div class="mb-8">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">Mis Proyectos</h2>
        <a href="{% url 'core:project_create' %}" class="btn btn-primary bg-black text-white hover:bg-gray-800 px-4 py-2 rounded-md">
            Nuevo Proyecto
        </a>
    </div>

    {% if projects %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for project in projects %}
        <div class="card bg-white shadow-xl hover:shadow-2xl transition-all duration-300 border border-gray-200 rounded-lg overflow-hidden">
            <div class="card-body p-6">
                <h2 class="card-title text-xl font-bold mb-3">
                    {{ project.name }}
                </h2>
                
                {% comment %} Estad√≠sticas del proyecto {% endcomment %}
                <div class="mb-4">
                    {% comment %} Badges de contenido {% endcomment %}
                    <div class="flex flex-wrap gap-2 mb-3">
                        {% if project.video_count > 0 %}
                        <div class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium">
                            <span>üé¨</span>
                            <span>{{ project.video_count }} video{{ project.video_count|pluralize }}</span>
                            {% if project.completed_videos > 0 %}
                            <span class="text-blue-500">‚Ä¢</span>
                            <span class="text-blue-600 font-semibold">{{ project.completed_videos }} listo{{ project.completed_videos|pluralize:"s" }}</span>
                            {% endif %}
                        </div>
                        {% endif %}
                        
                        {% if project.image_count > 0 %}
                        <div class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-purple-50 text-purple-700 rounded-full text-xs font-medium">
                            <span>üñºÔ∏è</span>
                            <span>{{ project.image_count }} imagen{{ project.image_count|pluralize:"es" }}</span>
                            {% if project.completed_images > 0 %}
                            <span class="text-purple-500">‚Ä¢</span>
                            <span class="text-purple-600 font-semibold">{{ project.completed_images }} listo{{ project.completed_images|pluralize:"s" }}</span>
                            {% endif %}
                        </div>
                        {% endif %}
                        
                        {% if project.audios.count > 0 %}
                        <div class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-green-50 text-green-700 rounded-full text-xs font-medium">
                            <span>üéôÔ∏è</span>
                            <span>{{ project.audios.count }} audio{{ project.audios.count|pluralize }}</span>
                        </div>
                        {% endif %}
                        
                        {% if project.music_tracks.count > 0 %}
                        <div class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-pink-50 text-pink-700 rounded-full text-xs font-medium">
                            <span>üéµ</span>
                            <span>{{ project.music_tracks.count }} m√∫sica</span>
                        </div>
                        {% endif %}
                        
                        {% if project.script_count > 0 %}
                        <div class="inline-flex items-center gap-1.5 px-2.5 py-1 bg-orange-50 text-orange-700 rounded-full text-xs font-medium">
                            <span>üìù</span>
                            <span>{{ project.script_count }} gui√≥n{{ project.script_count|pluralize:"es" }}</span>
                        </div>
                        {% endif %}
                    </div>
                    
                    {% comment %} Fecha de creaci√≥n {% endcomment %}
                    <div class="flex items-center gap-1 text-xs text-gray-400">
                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <span>Creado {{ project.created_at|date:"d M Y" }}</span>
                    </div>
                </div>
                
                {% comment %} Colaboradores del proyecto {% endcomment %}
                {% if project.owner or project.members.exists %}
                <div class="mb-4 pt-4 border-t border-gray-200">
                    <div class="flex items-center gap-2">
                        <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Colaboradores</span>
                        <div class="flex -space-x-2">
                            {% if project.owner %}
                            <div class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-xs font-semibold border-2 border-white" 
                                 title="{{ project.owner.get_full_name|default:project.owner.username }} (Propietario)">
                                {{ project.owner.first_name|first|default:project.owner.username|first|upper }}
                            </div>
                            {% endif %}
                            {% for member in project.members.all %}
                                {% if forloop.counter <= 4 %}
                                <div class="w-8 h-8 rounded-full bg-gray-400 text-white flex items-center justify-center text-xs font-semibold border-2 border-white" 
                                     title="{{ member.user.get_full_name|default:member.user.username }} ({{ member.get_role_display }})">
                                    {{ member.user.first_name|first|default:member.user.username|first|upper }}
                                </div>
                                {% endif %}
                            {% endfor %}
                            {% if project.members.count > 4 %}
                            <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center text-xs font-semibold border-2 border-white" 
                                 title="Y {{ project.members.count|add:"-4" }} m√°s">
                                +{{ project.members.count|add:"-4" }}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <div class="card-actions justify-end mt-4">
                    <a href="{% url 'core:project_detail' project.id %}" 
                       class="btn btn-primary btn-sm bg-black text-white hover:bg-gray-800 px-3 py-1 rounded-md text-sm">
                        Ver Proyecto
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- Estado vac√≠o -->
    <div class="hero min-h-[400px] bg-gray-50 rounded-2xl border-2 border-dashed border-gray-300">
        <div class="hero-content text-center">
            <div class="max-w-md">
                <div class="text-6xl mb-4 opacity-30">üìÅ</div>
                <h1 class="text-3xl font-bold text-gray-800">No hay proyectos</h1>
                <p class="py-6 text-gray-600">
                    Crea tu primer proyecto para comenzar a generar videos e im√°genes con IA
                </p>
                <a href="{% url 'core:project_create' %}" class="btn btn-primary bg-black text-white hover:bg-gray-800 px-6 py-3 rounded-md">
                    Crear Primer Proyecto
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

